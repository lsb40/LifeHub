<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeHub Test</title>
    <style>
        * {
            background-color: transparent !important;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            background: linear-gradient(135deg, #0f4c3a 0%, #1a5f4a 25%, #2d7a5f 50%, #4a9d7a 75%, #6bbf8a 100%);
            overflow-x: hidden;
            position: relative;
        }
        
        /* Animated Nature Background */
        .nature-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }
        
        .clouds {
            position: absolute;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 300"><path d="M100,150 Q200,100 300,150 T500,150 T700,150 T900,150" stroke="rgba(255,255,255,0.3)" stroke-width="3" fill="none"/></svg>') repeat-x;
            animation: float 20s infinite linear;
        }
        
        .particles {
            position: absolute;
            width: 100%;
            height: 100%;
        }
        
        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: rgba(255,255,255,0.6);
            border-radius: 50%;
            animation: float 15s infinite linear;
            box-shadow: 0 0 10px rgba(255,255,255,0.3);
        }
        
        .mountains {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 200px;
            background: linear-gradient(45deg, #1a4d3a 0%, #2d6a4f 50%, #1a4d3a 100%);
            clip-path: polygon(0% 100%, 0% 60%, 20% 40%, 40% 50%, 60% 30%, 80% 45%, 100% 35%, 100% 100%);
        }
        
        .trees {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 150px;
        }
        
        .tree {
            position: absolute;
            bottom: 0;
            width: 20px;
            height: 80px;
            background: #2d5a2d;
            border-radius: 10px 10px 0 0;
            animation: sway 6s infinite ease-in-out;
        }
        
        .tree::before {
            content: '';
            position: absolute;
            top: -30px;
            left: -15px;
            width: 50px;
            height: 50px;
            background: #4a7c4a;
            border-radius: 50%;
        }
        
        .birds {
            position: absolute;
            width: 100%;
            height: 100%;
        }
        
        .bird {
            position: absolute;
            width: 20px;
            height: 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            animation: fly 25s infinite linear;
        }
        
        .sun-rays {
            position: absolute;
            top: 50px;
            right: 50px;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
            border-radius: 50%;
            animation: pulse 4s infinite ease-in-out;
            box-shadow: 0 0 30px rgba(255,255,255,0.1);
        }
        
        .leaves {
            position: absolute;
            width: 100%;
            height: 100%;
        }
        
        .leaf {
            position: absolute;
            width: 8px;
            height: 12px;
            background: #4a7c4a;
            border-radius: 50% 0;
            animation: fall 8s infinite linear;
        }
        
        .grass {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 30px;
        }
        
        .grass-blade {
            position: absolute;
            bottom: 0;
            width: 2px;
            height: 20px;
            background: #4a7c4a;
            border-radius: 1px;
            animation: sway 3s infinite ease-in-out;
        }
        
        .flowers {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 40px;
        }
        
        .flower {
            position: absolute;
            bottom: 0;
            width: 6px;
            height: 6px;
            background: #ff6b9d;
            border-radius: 50%;
            animation: bloom 5s infinite ease-in-out;
        }
        
        @keyframes float {
            0% { transform: translateX(-100px); }
            100% { transform: translateX(calc(100vw + 100px)); }
        }
        
        @keyframes fly {
            0% { transform: translateX(-50px) translateY(0px); }
            25% { transform: translateX(25vw) translateY(-20px); }
            50% { transform: translateX(50vw) translateY(10px); }
            75% { transform: translateX(75vw) translateY(-15px); }
            100% { transform: translateX(calc(100vw + 50px)) translateY(0px); }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.2); opacity: 0.6; }
        }
        
        @keyframes fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }
        
        @keyframes sway {
            0%, 100% { transform: rotate(-2deg); }
            50% { transform: rotate(2deg); }
        }
        
        @keyframes bloom {
            0%, 100% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.3); opacity: 1; }
        }
        
        @keyframes ripple {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(4);
                opacity: 0;
            }
        }
        
        @keyframes sway {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(2deg); }
            75% { transform: rotate(-2deg); }
        }
        /* Glass Effect Styles */
        .glass-effect {
            background: rgba(240, 248, 240, 0.85) !important;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
            background: rgba(240, 248, 240, 0.85) !important;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-top: 50px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #0d3d0d;
            font-size: 14px;
        }
        input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid rgba(45, 90, 45, 0.3);
            border-radius: 10px;
            box-sizing: border-box;
            background: rgba(245, 252, 245, 0.9) !important;
            color: #0d3d0d;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        input:focus {
            outline: none;
            border-color: #4a7c4a;
            box-shadow: 0 0 0 3px rgba(74, 124, 74, 0.2);
        }
        input::placeholder {
            color: #6b8e6b;
        }
        button {
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, #4a7c4a 0%, #5a8c5a 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(74, 124, 74, 0.3);
        }
        button:hover {
            background: linear-gradient(135deg, #5a8c5a 0%, #6a9c6a 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 124, 74, 0.4);
        }
        button:active {
            transform: translateY(0);
        }
        .message {
            margin-top: 20px;
            padding: 12px 16px;
            border-radius: 10px;
            display: none;
            font-weight: 500;
            text-align: center;
        }
        .success {
            background: rgba(212, 237, 218, 0.9) !important;
            color: #0d3d0d;
            border: 1px solid rgba(195, 230, 203, 0.5);
        }
        .error {
            background: rgba(248, 215, 218, 0.9) !important;
            color: #721c24;
            border: 1px solid rgba(245, 198, 203, 0.5);
        }
    </style>
</head>
<body>
    <!-- Animated Nature Background -->
    <div class="nature-bg">
        <div class="clouds"></div>
        <div class="particles" id="particles"></div>
        <div class="mountains"></div>
        <div class="trees" id="trees"></div>
        <div class="birds" id="birds"></div>
        <div class="sun-rays"></div>
        <div class="leaves" id="leaves"></div>
        <div class="grass" id="grass"></div>
        <div class="flowers" id="flowers"></div>
    </div>
    
    <div class="container">
        <h1 style="text-align: center; color: #0d3d0d; font-size: 28px; margin-bottom: 30px; text-shadow: 0 2px 4px rgba(0,0,0,0.1);">üå± LifeHub</h1>
        
        <form id="loginForm">
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" placeholder="Enter your email" required>
            </div>
            
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" id="password" placeholder="Enter your password" required>
            </div>
            
            <button type="button" onclick="handleLogin()">üöÄ Sign In</button>
        </form>
        
        <div style="text-align: center; margin-top: 20px;">
            <p style="color: #0d3d0d; font-size: 14px;">Don't have an account? 
                <a href="#" onclick="showRegister()" style="color: #4a7c4a; font-weight: bold; text-decoration: none;">Sign up</a>
            </p>
        </div>
        
        <div id="message" class="message"></div>
    </div>

    <script>
        function handleLogin() {
            console.log('Login function called');
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            console.log('Email:', email, 'Password:', password);
            
            if (!email || !password) {
                showMessage('Please enter both email and password.', 'error');
                return;
            }
            
            // Try backend login first
            fetch('http://localhost:8000/api/v1/auth/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    email: email,
                    password: password
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showMessage('‚úÖ Login successful! Loading dashboard...', 'success');
                    
                    // Store user data
                    localStorage.setItem('lifehub_user', JSON.stringify(data.data.user));
                    localStorage.setItem('lifehub_token', data.data.token);
                    
                    // Show dashboard after a short delay
                    setTimeout(() => {
                        showDashboard();
                    }, 1000);
                } else {
                    showMessage('‚ùå Invalid credentials. Please check your email and password.', 'error');
                }
            })
            .catch(error => {
                console.log('Backend not available, using local authentication');
                // Fallback to local authentication for demo purposes
                if (email && password) {
                    showMessage('‚úÖ Login successful! Loading dashboard...', 'success');
                    
                    // Store user data
                    localStorage.setItem('lifehub_user', JSON.stringify({
                        id: 'user-' + Date.now(),
                        email: email,
                        firstName: email.split('@')[0],
                        lastName: 'User',
                        role: 'USER'
                    }));
                    localStorage.setItem('lifehub_token', 'local-token-' + Date.now());
                    
                    // Show dashboard after a short delay
                    setTimeout(() => {
                        showDashboard();
                    }, 1000);
                } else {
                    showMessage('‚ùå Please enter both email and password.', 'error');
                }
            });
        }
        
        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = text;
            messageDiv.className = 'message ' + type;
            messageDiv.style.display = 'block';
        }
        
        function showRegister() {
            document.body.innerHTML = `
                <div style="min-height: 100vh; background: linear-gradient(135deg, #0f4c3a 0%, #1a5f4a 25%, #2d7a5f 50%, #4a9d7a 75%, #6bbf8a 100%); padding: 20px; position: relative; display: flex; align-items: center; justify-content: center;">
                    <!-- Animated Nature Background -->
                    <div class="nature-bg">
                        <div class="clouds"></div>
                        <div class="particles" id="particles"></div>
                        <div class="mountains"></div>
                        <div class="trees" id="trees"></div>
                        <div class="birds" id="birds"></div>
                        <div class="sun-rays"></div>
                        <div class="leaves" id="leaves"></div>
                        <div class="grass" id="grass"></div>
                        <div class="flowers" id="flowers"></div>
                    </div>
                    
                    <div style="background: rgba(240, 248, 240, 0.4); backdrop-filter: blur(10px); padding: 40px; border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.2); max-width: 400px; width: 100%; position: relative; z-index: 10;">
                        <h1 style="text-align: center; color: white; font-size: 28px; margin-bottom: 30px; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">üå± LifeHub</h1>
                
                <form id="registerForm">
                    <div class="form-group">
                        <label for="firstName">First Name:</label>
                        <input type="text" id="firstName" placeholder="Enter your first name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="lastName">Last Name:</label>
                        <input type="text" id="lastName" placeholder="Enter your last name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Email:</label>
                        <input type="email" id="email" placeholder="Enter your email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">Password:</label>
                        <input type="password" id="password" placeholder="Enter your password" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="confirmPassword">Confirm Password:</label>
                        <input type="password" id="confirmPassword" placeholder="Confirm your password" required>
                    </div>
                    
                    <button type="button" onclick="handleRegister()">üöÄ Create Account</button>
                </form>
                
                <div style="text-align: center; margin-top: 20px;">
                    <p style="color: #0d3d0d; font-size: 14px;">Already have an account? 
                        <a href="#" onclick="showLogin()" style="color: #4a7c4a; font-weight: bold; text-decoration: none;">Sign in</a>
                    </p>
                </div>
                
                        <div id="message" class="message"></div>
                    </div>
                </div>
            `;
            
            // Create nature elements
            createNatureElements();
        }
        
        function showLogin() {
            document.body.innerHTML = `
                <div style="min-height: 100vh; background: linear-gradient(135deg, #0f4c3a 0%, #1a5f4a 25%, #2d7a5f 50%, #4a9d7a 75%, #6bbf8a 100%); padding: 20px; position: relative; display: flex; align-items: center; justify-content: center;">
                    <!-- Animated Nature Background -->
                    <div class="nature-bg">
                        <div class="clouds"></div>
                        <div class="particles" id="particles"></div>
                        <div class="mountains"></div>
                        <div class="trees" id="trees"></div>
                        <div class="birds" id="birds"></div>
                        <div class="sun-rays"></div>
                        <div class="leaves" id="leaves"></div>
                        <div class="grass" id="grass"></div>
                        <div class="flowers" id="flowers"></div>
                    </div>
                    
                    <div style="background: rgba(240, 248, 240, 0.4); backdrop-filter: blur(10px); padding: 40px; border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.2); max-width: 400px; width: 100%; position: relative; z-index: 10;">
                        <h1 style="text-align: center; color: white; font-size: 28px; margin-bottom: 30px; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">üå± LifeHub</h1>
                        
                        <form id="loginForm">
                            <div class="form-group">
                                <label for="email">Email:</label>
                                <input type="email" id="email" placeholder="Enter your email" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="password">Password:</label>
                                <input type="password" id="password" placeholder="Enter your password" required>
                            </div>
                            
                            <button type="button" onclick="handleLogin()">üöÄ Sign In</button>
                        </form>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <p style="color: #0d3d0d; font-size: 14px;">Don't have an account? 
                                <a href="#" onclick="showRegister()" style="color: #4a7c4a; font-weight: bold; text-decoration: none;">Sign up</a>
                            </p>
                        </div>
                        
                        <div id="message" class="message"></div>
                    </div>
                </div>
            `;
            
            // Create nature elements
            createNatureElements();
        }
        
        function handleRegister() {
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (!firstName || !lastName || !email || !password || !confirmPassword) {
                showMessage('Please fill in all fields.', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showMessage('Passwords do not match.', 'error');
                return;
            }
            
            if (password.length < 6) {
                showMessage('Password must be at least 6 characters long.', 'error');
                return;
            }
            
            // Try backend registration first
            fetch('http://localhost:8000/api/v1/auth/register', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    firstName,
                    lastName,
                    email,
                    password
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showMessage('‚úÖ Account created successfully! Redirecting to dashboard...', 'success');
                    
                    // Store user data
                    localStorage.setItem('lifehub_user', JSON.stringify(data.data.user));
                    localStorage.setItem('lifehub_token', data.data.token);
                    
                    // Show dashboard after a short delay
                    setTimeout(() => {
                        showDashboard();
                    }, 1500);
                } else {
                    showMessage('‚ùå ' + (data.message || 'Registration failed. Please try again.'), 'error');
                }
            })
            .catch(error => {
                console.log('Backend not available, using local registration');
                // Fallback to local registration
                showMessage('‚úÖ Account created successfully! Redirecting to dashboard...', 'success');
                
                // Store user data locally
                const newUser = {
                    id: 'user-' + Date.now(),
                    email: email,
                    firstName: firstName,
                    lastName: lastName,
                    role: 'USER'
                };
                
                localStorage.setItem('lifehub_user', JSON.stringify(newUser));
                localStorage.setItem('lifehub_token', 'local-token-' + Date.now());
                
                // Show dashboard after a short delay
                setTimeout(() => {
                    showDashboard();
                }, 1500);
            });
        }
        
        function showDashboard() {
            const user = JSON.parse(localStorage.getItem('lifehub_user'));
            document.body.innerHTML = `
                <div style="min-height: 100vh; background: linear-gradient(135deg, #0f4c3a 0%, #1a5f4a 25%, #2d7a5f 50%, #4a9d7a 75%, #6bbf8a 100%); padding: 20px; position: relative;">
                    <!-- Animated Nature Background -->
                    <div class="nature-bg">
                        <div class="clouds"></div>
                        <div class="particles" id="particles"></div>
                        <div class="mountains"></div>
                        <div class="trees" id="trees"></div>
                        <div class="birds" id="birds"></div>
                        <div class="sun-rays"></div>
                        <div class="leaves" id="leaves"></div>
                        <div class="grass" id="grass"></div>
                        <div class="flowers" id="flowers"></div>
                    </div>
                    
                    <div style="max-width: 1200px; margin: 0 auto; position: relative; z-index: 10; padding: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; background: rgba(240, 248, 240, 0.3); backdrop-filter: blur(10px); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.2);">
                            <h1 style="color: white; margin: 0; font-size: 32px; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">üå± LifeHub Dashboard</h1>
                            <div>
                                <span style="color: white; margin-right: 20px; font-weight: 500; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">Welcome, ${user.firstName}!</span>
                                <button onclick="logout()" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3); transition: all 0.3s ease;">Logout</button>
                            </div>
                        </div>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                                <div class="glass-effect" style="padding: 25px; border-radius: 12px; text-align: center; background: rgba(240, 248, 240, 0.4) !important; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                                    <h3 style="color: white; margin: 0 0 15px 0; font-size: 20px; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">üçé Nutrition</h3>
                                    <p style="color: #0d3d0d; margin: 0 0 20px 0; font-size: 14px;">Track your meals and calories</p>
                                    <button onclick="showCategory('nutrition')" style="background: linear-gradient(135deg, #1e5f1e 0%, #0d3d0d 100%); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(13, 61, 13, 0.4); transition: all 0.3s ease;">View</button>
                                </div>
                                
                                <div class="glass-effect" style="padding: 25px; border-radius: 12px; text-align: center; background: rgba(240, 248, 240, 0.4) !important; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                                    <h3 style="color: white; margin: 0 0 15px 0; font-size: 20px; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">üíß Water</h3>
                                    <p style="color: #0d3d0d; margin: 0 0 20px 0; font-size: 14px;">Track your hydration</p>
                                    <button onclick="showCategory('water')" style="background: linear-gradient(135deg, #1e5f1e 0%, #0d3d0d 100%); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(13, 61, 13, 0.4); transition: all 0.3s ease;">View</button>
                                </div>
                                
                                <div class="glass-effect" style="padding: 25px; border-radius: 12px; text-align: center; background: rgba(240, 248, 240, 0.4) !important; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                                    <h3 style="color: white; margin: 0 0 15px 0; font-size: 20px; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">üèÉ Exercise</h3>
                                    <p style="color: #0d3d0d; margin: 0 0 20px 0; font-size: 14px;">Log your workouts</p>
                                    <button onclick="showCategory('exercise')" style="background: linear-gradient(135deg, #1e5f1e 0%, #0d3d0d 100%); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(13, 61, 13, 0.4); transition: all 0.3s ease;">View</button>
                                </div>
                                
                                <div class="glass-effect" style="padding: 25px; border-radius: 12px; text-align: center; background: rgba(240, 248, 240, 0.4) !important; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                                    <h3 style="color: white; margin: 0 0 15px 0; font-size: 20px; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">üòä Mood</h3>
                                    <p style="color: #0d3d0d; margin: 0 0 20px 0; font-size: 14px;">Track your mood</p>
                                    <button onclick="showCategory('mood')" style="background: linear-gradient(135deg, #1e5f1e 0%, #0d3d0d 100%); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(13, 61, 13, 0.4); transition: all 0.3s ease;">View</button>
                                </div>
                                
                                <div class="glass-effect" style="padding: 25px; border-radius: 12px; text-align: center; background: rgba(240, 248, 240, 0.4) !important; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                                    <h3 style="color: white; margin: 0 0 15px 0; font-size: 20px; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">üìä Analytics</h3>
                                    <p style="color: #0d3d0d; margin: 0 0 20px 0; font-size: 14px;">View your health insights</p>
                                    <button onclick="showCategory('analytics')" style="background: linear-gradient(135deg, #1e5f1e 0%, #0d3d0d 100%); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(13, 61, 13, 0.4); transition: all 0.3s ease;">View</button>
                                </div>
                                
                                <div class="glass-effect" style="padding: 25px; border-radius: 12px; text-align: center; background: rgba(240, 248, 240, 0.4) !important; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                                    <h3 style="color: white; margin: 0 0 15px 0; font-size: 20px; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">üò¥ Sleep</h3>
                                    <p style="color: #0d3d0d; margin: 0 0 20px 0; font-size: 14px;">Track sleep quality</p>
                                    <button onclick="showCategory('sleep')" style="background: linear-gradient(135deg, #1e5f1e 0%, #0d3d0d 100%); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(13, 61, 13, 0.4); transition: all 0.3s ease;">View</button>
                                </div>
                                
                                <div class="glass-effect" style="padding: 25px; border-radius: 12px; text-align: center; background: rgba(240, 248, 240, 0.4) !important; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                                    <h3 style="color: white; margin: 0 0 15px 0; font-size: 20px; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">üìÖ Habits</h3>
                                    <p style="color: #0d3d0d; margin: 0 0 20px 0; font-size: 14px;">Build daily habits</p>
                                    <button onclick="showCategory('habits')" style="background: linear-gradient(135deg, #1e5f1e 0%, #0d3d0d 100%); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(13, 61, 13, 0.4); transition: all 0.3s ease;">View</button>
                                </div>
                                
                                <div class="glass-effect" style="padding: 25px; border-radius: 12px; text-align: center; background: rgba(240, 248, 240, 0.4) !important; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                                    <h3 style="color: white; margin: 0 0 15px 0; font-size: 20px; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">ü©∫ Medical</h3>
                                    <p style="color: #0d3d0d; margin: 0 0 20px 0; font-size: 14px;">Track health vitals</p>
                                    <button onclick="showCategory('medical')" style="background: linear-gradient(135deg, #1e5f1e 0%, #0d3d0d 100%); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(13, 61, 13, 0.4); transition: all 0.3s ease;">View</button>
                                </div>
                            </div>
                            
                            <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(240, 248, 240, 0.4) !important; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                                <h3 style="color: white; margin: 0 0 20px 0; font-size: 24px; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">üìä Today's Summary</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                                    <div style="text-align: center; padding: 15px; background: rgba(40, 167, 69, 0.1); border-radius: 8px;">
                                        <div style="font-size: 24px; font-weight: bold; color: #28a745;" id="dashboardCalories">0</div>
                                        <div style="color: #0d3d0d; font-weight: 500; font-size: 12px;">Calories</div>
                                    </div>
                                    <div style="text-align: center; padding: 15px; background: rgba(0, 123, 255, 0.1); border-radius: 8px;">
                                        <div style="font-size: 24px; font-weight: bold; color: #007bff;" id="dashboardWater">0ml</div>
                                        <div style="color: #0d3d0d; font-weight: 500; font-size: 12px;">Water</div>
                                    </div>
                                    <div style="text-align: center; padding: 15px; background: rgba(253, 126, 20, 0.1); border-radius: 8px;">
                                        <div style="font-size: 24px; font-weight: bold; color: #fd7e14;" id="dashboardExercise">0</div>
                                        <div style="color: #0d3d0d; font-weight: 500; font-size: 12px;">Exercise</div>
                                    </div>
                                    <div style="text-align: center; padding: 15px; background: rgba(111, 66, 193, 0.1); border-radius: 8px;">
                                        <div style="font-size: 24px; font-weight: bold; color: #6f42c1;" id="dashboardMood">üòä</div>
                                        <div style="color: #0d3d0d; font-weight: 500; font-size: 12px;">Mood</div>
                                    </div>
                                    <div style="text-align: center; padding: 15px; background: rgba(33, 150, 243, 0.1); border-radius: 8px;">
                                        <div style="font-size: 24px; font-weight: bold; color: #2196f3;" id="dashboardSleep">0h</div>
                                        <div style="color: #0d3d0d; font-weight: 500; font-size: 12px;">Sleep</div>
                                    </div>
                                    <div style="text-align: center; padding: 15px; background: rgba(76, 175, 80, 0.1); border-radius: 8px;">
                                        <div style="font-size: 24px; font-weight: bold; color: #4caf50;" id="dashboardHabits">0</div>
                                        <div style="color: #0d3d0d; font-weight: 500; font-size: 12px;">Habits</div>
                                    </div>
                                    <div style="text-align: center; padding: 15px; background: rgba(244, 67, 54, 0.1); border-radius: 8px;">
                                        <div style="font-size: 24px; font-weight: bold; color: #f44336;" id="dashboardMedical">0</div>
                                        <div style="color: #0d3d0d; font-weight: 500; font-size: 12px;">Vitals</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Recreate nature elements for the dashboard
            createNatureElements();
            
            // Update dashboard summary with real data
            updateDashboardSummary();
        }
        
        function showCategory(category) {
            const user = JSON.parse(localStorage.getItem('lifehub_user'));
            
            let content = '';
            
            switch(category) {
                case 'nutrition':
                    content = getNutritionContent();
                    break;
                case 'water':
                    content = getWaterContent();
                    break;
                case 'exercise':
                    content = getExerciseContent();
                    break;
                case 'mood':
                    content = getMoodContent();
                    break;
                case 'analytics':
                    content = getAnalyticsContent();
                    break;
                case 'sleep':
                    content = getSleepContent();
                    break;
                case 'habits':
                    content = getHabitsContent();
                    break;
                case 'medical':
                    content = getMedicalContent();
                    break;
                default:
                    content = '<p style="color: #6c757d; text-align: center; padding: 40px;">Category not found.</p>';
            }
            
            document.body.innerHTML = `
                <div style="min-height: 100vh; background: linear-gradient(135deg, #0f4c3a 0%, #1a5f4a 25%, #2d7a5f 50%, #4a9d7a 75%, #6bbf8a 100%); padding: 20px; position: relative;">
                    <!-- Animated Nature Background -->
                    <div class="nature-bg">
                        <div class="clouds"></div>
                        <div class="particles" id="particles"></div>
                        <div class="mountains"></div>
                        <div class="trees" id="trees"></div>
                        <div class="birds" id="birds"></div>
                        <div class="sun-rays"></div>
                        <div class="leaves" id="leaves"></div>
                        <div class="grass" id="grass"></div>
                        <div class="flowers" id="flowers"></div>
                    </div>
                    
                    <div style="max-width: 1200px; margin: 0 auto; position: relative; z-index: 10; padding: 20px;">
                        <div style="background: rgba(240, 248, 240, 0.4); backdrop-filter: blur(10px); padding: 30px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.2);">
                            ${content}
                        </div>
                    </div>
                </div>
            `;
            
            // Recreate nature elements
            createNatureElements();
            
            // Load existing data for this category
            loadCategoryData(category);
            
            // Set default date to today for date inputs
            const today = new Date().toISOString().split('T')[0];
            console.log('Setting default date to:', today);
            const dateInputs = document.querySelectorAll('input[type="date"]');
            console.log('Found date inputs:', dateInputs.length);
            dateInputs.forEach(input => {
                if (!input.value) {
                    input.value = today;
                    console.log('Set date input to:', today);
                }
            });
        }
        
        function logout() {
            localStorage.removeItem('lifehub_user');
            localStorage.removeItem('lifehub_token');
            location.reload();
        }
        
        function getNutritionContent() {
            return `
                <div class="glass-effect" style="padding: 30px; border-radius: 15px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; margin-bottom: 30px;">
                        <button onclick="showDashboard()" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-right: 20px;">‚Üê Back</button>
                        <h1 style="color: #0d3d0d; margin: 0; font-size: 28px;">üçé Nutrition Tracking</h1>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(232, 245, 232, 0.9) !important;">
                            <h3 style="color: #2d5a2d; margin: 0 0 20px 0;">Add Food Entry</h3>
                            <form onsubmit="addNutritionEntry(event)">
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Food Name</label>
                                    <input type="text" id="foodName" placeholder="e.g., Apple, Chicken Breast" required style="width: 100%; padding: 10px; border: 2px solid rgba(45, 90, 45, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Calories</label>
                                    <input type="number" id="calories" placeholder="250" required style="width: 100%; padding: 10px; border: 2px solid rgba(45, 90, 45, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Quantity</label>
                                    <input type="text" id="quantity" placeholder="1 medium" required style="width: 100%; padding: 10px; border: 2px solid rgba(45, 90, 45, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Date</label>
                                    <input type="date" id="nutritionDate" required style="width: 100%; padding: 10px; border: 2px solid rgba(45, 90, 45, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <button type="submit" style="width: 100%; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold;">Add Entry</button>
                            </form>
                        </div>
                        
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(248, 249, 250, 0.9) !important;">
                            <h3 style="color: #0d3d0d; margin: 0 0 20px 0;">Today's Entries</h3>
                            <div id="nutritionEntries" style="max-height: 300px; overflow-y: auto;">
                                <p style="color: #6c757d; text-align: center; margin: 20px 0;">No entries yet. Add your first meal!</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function getAnalyticsContent() {
            return `
                <div class="glass-effect" style="padding: 30px; border-radius: 15px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; margin-bottom: 30px;">
                        <button onclick="showDashboard()" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-right: 20px;">‚Üê Back</button>
                        <h1 style="color: #0d3d0d; margin: 0; font-size: 28px;">üìä Analytics Dashboard</h1>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(40, 167, 69, 0.1) !important;">
                            <h3 style="color: #28a745; margin: 0 0 15px 0;">üçé Nutrition Summary</h3>
                            <div style="text-align: center;">
                                <div style="font-size: 36px; font-weight: bold; color: #28a745;" id="totalCalories">0</div>
                                <div style="color: #0d3d0d; font-weight: 500;">calories today</div>
                            </div>
                        </div>
                        
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(0, 123, 255, 0.1) !important;">
                            <h3 style="color: #007bff; margin: 0 0 15px 0;">üíß Hydration</h3>
                            <div style="text-align: center;">
                                <div style="font-size: 36px; font-weight: bold; color: #007bff;" id="totalWaterAnalytics">0</div>
                                <div style="color: #0d3d0d; font-weight: 500;">ml consumed</div>
                            </div>
                        </div>
                        
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(253, 126, 20, 0.1) !important;">
                            <h3 style="color: #fd7e14; margin: 0 0 15px 0;">üèÉ Exercise</h3>
                            <div style="text-align: center;">
                                <div style="font-size: 36px; font-weight: bold; color: #fd7e14;" id="totalExercise">0</div>
                                <div style="color: #0d3d0d; font-weight: 500;">minutes today</div>
                            </div>
                        </div>
                        
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(111, 66, 193, 0.1) !important;">
                            <h3 style="color: #6f42c1; margin: 0 0 15px 0;">üòä Average Mood</h3>
                            <div style="text-align: center;">
                                <div style="font-size: 36px; font-weight: bold; color: #6f42c1;" id="averageMood">üòä</div>
                                <div style="color: #0d3d0d; font-weight: 500;">today's mood</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(248, 249, 250, 0.9) !important; margin-top: 20px;">
                        <h3 style="color: #0d3d0d; margin: 0 0 20px 0;">üìà Weekly Trends</h3>
                        
                        <!-- Calorie Chart -->
                        <div style="margin-bottom: 30px;">
                            <h4 style="color: #28a745; margin: 0 0 15px 0;">üçé Daily Calories (Last 7 Days)</h4>
                            <div id="calorieChart" style="height: 200px; background: rgba(40, 167, 69, 0.1); border-radius: 8px; padding: 20px; position: relative;">
                                <canvas id="calorieCanvas" style="width: 100%; height: 160px; display: block;"></canvas>
                            </div>
                        </div>
                        
                        <!-- Water Chart -->
                        <div style="margin-bottom: 30px;">
                            <h4 style="color: #007bff; margin: 0 0 15px 0;">üíß Daily Water Intake (Last 7 Days)</h4>
                            <div id="waterChart" style="height: 200px; background: rgba(0, 123, 255, 0.1); border-radius: 8px; padding: 20px; position: relative;">
                                <canvas id="waterCanvas" style="width: 100%; height: 160px; display: block;"></canvas>
                            </div>
                        </div>
                        
                        <!-- Exercise Chart -->
                        <div style="margin-bottom: 30px;">
                            <h4 style="color: #fd7e14; margin: 0 0 15px 0;">üèÉ Daily Exercise (Last 7 Days)</h4>
                            <div id="exerciseChart" style="height: 200px; background: rgba(253, 126, 20, 0.1); border-radius: 8px; padding: 20px; position: relative;">
                                <canvas id="exerciseCanvas" style="width: 100%; height: 160px; display: block;"></canvas>
                            </div>
                        </div>
                        
                        <!-- Mood Chart -->
                        <div>
                            <h4 style="color: #6f42c1; margin: 0 0 15px 0;">üòä Daily Mood (Last 7 Days)</h4>
                            <div id="moodChart" style="height: 200px; background: rgba(111, 66, 193, 0.1); border-radius: 8px; padding: 20px; position: relative;">
                                <canvas id="moodCanvas" style="width: 100%; height: 160px; display: block;"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function getSleepContent() {
            return `
                <div class="glass-effect" style="padding: 30px; border-radius: 15px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; margin-bottom: 30px;">
                        <button onclick="showDashboard()" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-right: 20px;">‚Üê Back</button>
                        <h1 style="color: #0d3d0d; margin: 0; font-size: 28px;">üò¥ Sleep Tracking</h1>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(240, 248, 255, 0.9) !important;">
                            <h3 style="color: #1976d2; margin: 0 0 20px 0;">Log Sleep Session</h3>
                            <form onsubmit="addSleepEntry(event)">
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Sleep Duration (hours)</label>
                                    <input type="number" id="sleepDuration" placeholder="8.5" step="0.5" min="0" max="24" required style="width: 100%; padding: 10px; border: 2px solid rgba(25, 118, 210, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Sleep Quality</label>
                                    <select id="sleepQuality" required style="width: 100%; padding: 10px; border: 2px solid rgba(25, 118, 210, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                        <option value="">Select quality</option>
                                        <option value="üò¥">üò¥ Poor (1-3)</option>
                                        <option value="üòë">üòë Fair (4-5)</option>
                                        <option value="üòä">üòä Good (6-7)</option>
                                        <option value="üòÑ">üòÑ Great (8-9)</option>
                                        <option value="ü§©">ü§© Excellent (10)</option>
                                    </select>
                                </div>
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Notes (optional)</label>
                                    <textarea id="sleepNotes" placeholder="How did you feel when you woke up?" style="width: 100%; padding: 10px; border: 2px solid rgba(25, 118, 210, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important; height: 80px; resize: vertical;"></textarea>
                                </div>
                                <button type="submit" style="width: 100%; background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold;">Log Sleep</button>
                            </form>
                        </div>
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(248, 249, 250, 0.9) !important;">
                            <h3 style="color: #0d3d0d; margin: 0 0 20px 0;">Recent Sleep Logs</h3>
                            <div id="sleepEntries" style="max-height: 300px; overflow-y: auto;">
                                <p style="color: #6c757d; text-align: center; margin: 20px 0;">No sleep logs yet. Log your first night!</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function getHabitsContent() {
            return `
                <div class="glass-effect" style="padding: 30px; border-radius: 15px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; margin-bottom: 30px;">
                        <button onclick="showDashboard()" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-right: 20px;">‚Üê Back</button>
                        <h1 style="color: #0d3d0d; margin: 0; font-size: 28px;">üìÖ Habit Tracker</h1>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(248, 255, 248, 0.9) !important;">
                            <h3 style="color: #388e3c; margin: 0 0 20px 0;">Add New Habit</h3>
                            <form onsubmit="addHabit(event)">
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Habit Name</label>
                                    <input type="text" id="habitName" placeholder="e.g., Morning Meditation" required style="width: 100%; padding: 10px; border: 2px solid rgba(56, 142, 60, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Frequency</label>
                                    <select id="habitFrequency" required style="width: 100%; padding: 10px; border: 2px solid rgba(56, 142, 60, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                        <option value="">Select frequency</option>
                                        <option value="daily">Daily</option>
                                        <option value="weekly">Weekly</option>
                                        <option value="monthly">Monthly</option>
                                    </select>
                                </div>
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Description (optional)</label>
                                    <textarea id="habitDescription" placeholder="Why is this habit important to you?" style="width: 100%; padding: 10px; border: 2px solid rgba(56, 142, 60, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important; height: 80px; resize: vertical;"></textarea>
                                </div>
                                <button type="submit" style="width: 100%; background: linear-gradient(135deg, #4caf50 0%, #388e3c 100%); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold;">Add Habit</button>
                            </form>
                        </div>
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(248, 249, 250, 0.9) !important;">
                            <h3 style="color: #0d3d0d; margin: 0 0 20px 0;">Your Habits</h3>
                            <div id="habitsList" style="max-height: 300px; overflow-y: auto;">
                                <p style="color: #6c757d; text-align: center; margin: 20px 0;">No habits yet. Start building your first habit!</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function getMedicalContent() {
            return `
                <div class="glass-effect" style="padding: 30px; border-radius: 15px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; margin-bottom: 30px;">
                        <button onclick="showDashboard()" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-right: 20px;">‚Üê Back</button>
                        <h1 style="color: #0d3d0d; margin: 0; font-size: 28px;">ü©∫ Medical & Vitals</h1>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(255, 245, 245, 0.9) !important;">
                            <h3 style="color: #d32f2f; margin: 0 0 20px 0;">Log Health Metrics</h3>
                            <form onsubmit="addMedicalEntry(event)">
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Metric Type</label>
                                    <select id="medicalType" required style="width: 100%; padding: 10px; border: 2px solid rgba(211, 47, 47, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                        <option value="">Select metric</option>
                                        <option value="blood_pressure">Blood Pressure (mmHg)</option>
                                        <option value="heart_rate">Heart Rate (bpm)</option>
                                        <option value="glucose">Blood Glucose (mg/dL)</option>
                                        <option value="weight">Weight (lbs)</option>
                                        <option value="temperature">Temperature (¬∞F)</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Value</label>
                                    <input type="number" id="medicalValue" placeholder="120" step="0.1" required style="width: 100%; padding: 10px; border: 2px solid rgba(211, 47, 47, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Additional Info (optional)</label>
                                    <input type="text" id="medicalInfo" placeholder="e.g., 80/120 for blood pressure" style="width: 100%; padding: 10px; border: 2px solid rgba(211, 47, 47, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Notes (optional)</label>
                                    <textarea id="medicalNotes" placeholder="How are you feeling?" style="width: 100%; padding: 10px; border: 2px solid rgba(211, 47, 47, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important; height: 80px; resize: vertical;"></textarea>
                                </div>
                                <button type="submit" style="width: 100%; background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold;">Log Metric</button>
                            </form>
                        </div>
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(248, 249, 250, 0.9) !important;">
                            <h3 style="color: #0d3d0d; margin: 0 0 20px 0;">Recent Health Metrics</h3>
                            <div id="medicalEntries" style="max-height: 300px; overflow-y: auto;">
                                <p style="color: #6c757d; text-align: center; margin: 20px 0;">No health metrics logged yet. Start tracking your vitals!</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function getWaterContent() {
            return `
                <div class="glass-effect" style="padding: 30px; border-radius: 15px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; margin-bottom: 30px;">
                        <button onclick="showDashboard()" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-right: 20px;">‚Üê Back</button>
                        <h1 style="color: #0d3d0d; margin: 0; font-size: 28px;">üíß Water Tracking</h1>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(227, 242, 253, 0.9) !important;">
                            <h3 style="color: #1565c0; margin: 0 0 20px 0;">Add Water Intake</h3>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px;">
                                <button onclick="addWater(250)" style="background: #007bff; color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-weight: bold;">250ml</button>
                                <button onclick="addWater(500)" style="background: #007bff; color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-weight: bold;">500ml</button>
                                <button onclick="addWater(750)" style="background: #007bff; color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-weight: bold;">750ml</button>
                            </div>
                            <form onsubmit="addCustomWater(event)">
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Custom Amount (ml)</label>
                                    <input type="number" id="customWater" placeholder="300" style="width: 100%; padding: 10px; border: 2px solid rgba(0, 123, 255, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Date</label>
                                    <input type="date" id="waterDate" required style="width: 100%; padding: 10px; border: 2px solid rgba(0, 123, 255, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <button type="submit" style="width: 100%; background: linear-gradient(135deg, #007bff 0%, #0056b3 100%); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold;">Add Custom</button>
                            </form>
                        </div>
                        
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(248, 249, 250, 0.9) !important;">
                            <h3 style="color: #0d3d0d; margin: 0 0 20px 0;">Today's Water Intake</h3>
                            <div style="text-align: center; margin-bottom: 20px;">
                                <div style="font-size: 48px; font-weight: bold; color: #007bff;" id="totalWater">0</div>
                                <div style="color: #0d3d0d; font-weight: 500;">ml consumed</div>
                            </div>
                            <div id="waterEntries" style="max-height: 200px; overflow-y: auto;">
                                <p style="color: #6c757d; text-align: center; margin: 20px 0;">No water logged yet. Stay hydrated!</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function getExerciseContent() {
            return `
                <div class="glass-effect" style="padding: 30px; border-radius: 15px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; margin-bottom: 30px;">
                        <button onclick="showDashboard()" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-right: 20px;">‚Üê Back</button>
                        <h1 style="color: #0d3d0d; margin: 0; font-size: 28px;">üèÉ Exercise Tracking</h1>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(255, 243, 224, 0.9) !important;">
                            <h3 style="color: #ef6c00; margin: 0 0 20px 0;">Log Exercise</h3>
                            <form onsubmit="addExerciseEntry(event)">
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Exercise Type</label>
                                    <input type="text" id="exerciseType" placeholder="e.g., Running, Yoga, Weightlifting" required style="width: 100%; padding: 10px; border: 2px solid rgba(253, 126, 20, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Duration (minutes)</label>
                                    <input type="number" id="duration" placeholder="30" required style="width: 100%; padding: 10px; border: 2px solid rgba(253, 126, 20, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Calories Burned</label>
                                    <input type="number" id="caloriesBurned" placeholder="200" style="width: 100%; padding: 10px; border: 2px solid rgba(253, 126, 20, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Date</label>
                                    <input type="date" id="exerciseDate" required style="width: 100%; padding: 10px; border: 2px solid rgba(253, 126, 20, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <button type="submit" style="width: 100%; background: linear-gradient(135deg, #fd7e14 0%, #e55a00 100%); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold;">Log Exercise</button>
                            </form>
                        </div>
                        
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(248, 249, 250, 0.9) !important;">
                            <h3 style="color: #0d3d0d; margin: 0 0 20px 0;">Today's Workouts</h3>
                            <div id="exerciseEntries" style="max-height: 300px; overflow-y: auto;">
                                <p style="color: #6c757d; text-align: center; margin: 20px 0;">No workouts logged yet. Get moving!</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function getMoodContent() {
            return `
                <div class="glass-effect" style="padding: 30px; border-radius: 15px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; margin-bottom: 30px;">
                        <button onclick="showDashboard()" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; margin-right: 20px;">‚Üê Back</button>
                        <h1 style="color: #0d3d0d; margin: 0; font-size: 28px;">üòä Mood Tracking</h1>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(243, 229, 245, 0.9) !important;">
                            <h3 style="color: #7b1fa2; margin: 0 0 20px 0;">How are you feeling?</h3>
                            <form onsubmit="addMoodEntry(event)">
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; margin-bottom: 10px; color: #0d3d0d; font-weight: bold;">Select your mood:</label>
                                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px;">
                                        <button type="button" onclick="selectMood('üò¢')" class="mood-btn" style="padding: 15px; font-size: 24px; border: 2px solid #dee2e6; border-radius: 8px; background: white; cursor: pointer; transition: all 0.3s ease;">üò¢</button>
                                        <button type="button" onclick="selectMood('üòê')" class="mood-btn" style="padding: 15px; font-size: 24px; border: 2px solid #dee2e6; border-radius: 8px; background: white; cursor: pointer; transition: all 0.3s ease;">üòê</button>
                                        <button type="button" onclick="selectMood('üòä')" class="mood-btn" style="padding: 15px; font-size: 24px; border: 2px solid #dee2e6; border-radius: 8px; background: white; cursor: pointer; transition: all 0.3s ease;">üòä</button>
                                        <button type="button" onclick="selectMood('üòÑ')" class="mood-btn" style="padding: 15px; font-size: 24px; border: 2px solid #dee2e6; border-radius: 8px; background: white; cursor: pointer; transition: all 0.3s ease;">üòÑ</button>
                                        <button type="button" onclick="selectMood('ü§©')" class="mood-btn" style="padding: 15px; font-size: 24px; border: 2px solid #dee2e6; border-radius: 8px; background: white; cursor: pointer; transition: all 0.3s ease;">ü§©</button>
                                    </div>
                                    <input type="hidden" id="selectedMood" required>
                                </div>
                                <div style="margin-bottom: 15px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Notes (optional)</label>
                                    <textarea id="moodNotes" rows="3" placeholder="How are you feeling? What's on your mind?" style="width: 100%; padding: 10px; border: 2px solid rgba(111, 66, 193, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important; resize: vertical;"></textarea>
                                </div>
                                <div style="margin-bottom: 20px;">
                                    <label style="display: block; margin-bottom: 5px; color: #0d3d0d; font-weight: bold;">Date</label>
                                    <input type="date" id="moodDate" required style="width: 100%; padding: 10px; border: 2px solid rgba(111, 66, 193, 0.3); border-radius: 8px; background: rgba(245, 252, 245, 0.9) !important;">
                                </div>
                                <button type="submit" style="width: 100%; background: linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold;">Log Mood</button>
                            </form>
                        </div>
                        
                        <div class="glass-effect" style="padding: 25px; border-radius: 12px; background: rgba(248, 249, 250, 0.9) !important;">
                            <h3 style="color: #0d3d0d; margin: 0 0 20px 0;">Today's Mood Entries</h3>
                            <div id="moodEntries" style="max-height: 300px; overflow-y: auto;">
                                <p style="color: #6c757d; text-align: center; margin: 20px 0;">No mood entries yet. Check in with yourself!</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Data handling functions
        function getCurrentUserId() {
            const user = JSON.parse(localStorage.getItem('lifehub_user') || '{}');
            return user.id || 'anonymous';
        }
        
        function loadCategoryData(category) {
            const userId = getCurrentUserId();
            const userData = JSON.parse(localStorage.getItem(`lifehub_data_${userId}`) || '{}');
            const today = new Date().toDateString();
            
            switch(category) {
                case 'nutrition':
                    loadNutritionData(userData.nutrition || []);
                    break;
                case 'water':
                    loadWaterData(userData.water || []);
                    break;
                case 'exercise':
                    loadExerciseData(userData.exercise || []);
                    break;
                case 'mood':
                    loadMoodData(userData.mood || []);
                    break;
                case 'analytics':
                    loadAnalyticsData(userData);
                    break;
                case 'sleep':
                    loadSleepData(userData.sleep || []);
                    break;
                case 'habits':
                    loadHabitsData(userData.habits || []);
                    break;
                case 'medical':
                    loadMedicalData(userData.medical || []);
                    break;
            }
        }
        
        function saveData(category, data) {
            const userId = getCurrentUserId();
            const userData = JSON.parse(localStorage.getItem(`lifehub_data_${userId}`) || '{}');
            userData[category] = data;
            localStorage.setItem(`lifehub_data_${userId}`, JSON.stringify(userData));
        }
        
        // Update dashboard summary with real data
        function updateDashboardSummary() {
            const userId = getCurrentUserId();
            const userData = JSON.parse(localStorage.getItem(`lifehub_data_${userId}`) || '{}');
            const today = new Date().toDateString();
            
            // Calculate today's totals
            const todayNutrition = (userData.nutrition || []).filter(entry => 
                new Date(entry.timestamp).toDateString() === today
            );
            const todayWater = (userData.water || []).filter(entry => 
                new Date(entry.timestamp).toDateString() === today
            );
            const todayExercise = (userData.exercise || []).filter(entry => 
                new Date(entry.timestamp).toDateString() === today
            );
            const todayMood = (userData.mood || []).filter(entry => 
                new Date(entry.timestamp).toDateString() === today
            );
            
            // Calculate totals
            const totalCalories = todayNutrition.reduce((sum, entry) => sum + (entry.calories || 0), 0);
            const totalWater = todayWater.reduce((sum, entry) => sum + (entry.amount || 0), 0);
            const totalExercise = todayExercise.reduce((sum, entry) => sum + (entry.duration || 0), 0);
            
            // Calculate average mood
            let averageMood = 'üòä';
            if (todayMood.length > 0) {
                const moodValues = todayMood.map(entry => {
                    switch(entry.mood) {
                        case 'üò¢': return 1;
                        case 'üòê': return 2;
                        case 'üòä': return 3;
                        case 'üòÑ': return 4;
                        case 'ü§©': return 5;
                        default: return 3;
                    }
                });
                const avgMoodValue = moodValues.reduce((sum, val) => sum + val, 0) / moodValues.length;
                
                if (avgMoodValue <= 1.5) averageMood = 'üò¢';
                else if (avgMoodValue <= 2.5) averageMood = 'üòê';
                else if (avgMoodValue <= 3.5) averageMood = 'üòä';
                else if (avgMoodValue <= 4.5) averageMood = 'üòÑ';
                else averageMood = 'ü§©';
            }
            
            // Calculate sleep data
            const todaySleep = (userData.sleep || []).filter(entry => 
                new Date(entry.timestamp).toDateString() === today
            );
            const totalSleep = todaySleep.reduce((sum, entry) => sum + (entry.duration || 0), 0);
            
            // Calculate habits data
            const habits = userData.habits || [];
            const completedHabits = habits.filter(habit => 
                habit.completions.some(completion => 
                    new Date(completion.date).toDateString() === today
                )
            ).length;
            
            // Calculate medical data
            const todayMedical = (userData.medical || []).filter(entry => 
                new Date(entry.timestamp).toDateString() === today
            );
            const totalMedical = todayMedical.length;
            
            // Update dashboard elements
            const caloriesEl = document.getElementById('dashboardCalories');
            const waterEl = document.getElementById('dashboardWater');
            const exerciseEl = document.getElementById('dashboardExercise');
            const moodEl = document.getElementById('dashboardMood');
            const sleepEl = document.getElementById('dashboardSleep');
            const habitsEl = document.getElementById('dashboardHabits');
            const medicalEl = document.getElementById('dashboardMedical');
            
            if (caloriesEl) caloriesEl.textContent = totalCalories;
            if (waterEl) waterEl.textContent = totalWater + 'ml';
            if (exerciseEl) exerciseEl.textContent = totalExercise;
            if (moodEl) moodEl.textContent = averageMood;
            if (sleepEl) sleepEl.textContent = totalSleep + 'h';
            if (habitsEl) habitsEl.textContent = completedHabits;
            if (medicalEl) medicalEl.textContent = totalMedical;
        }
        
        // Create animated nature elements
        function createNatureElements() {
            // Clear existing elements to prevent duplicates
            const existingParticles = document.querySelectorAll('.particle');
            existingParticles.forEach(particle => particle.remove());
            
            const existingTrees = document.querySelectorAll('.tree');
            existingTrees.forEach(tree => tree.remove());
            
            const existingBirds = document.querySelectorAll('.bird');
            existingBirds.forEach(bird => bird.remove());
            
            const existingLeaves = document.querySelectorAll('.leaf');
            existingLeaves.forEach(leaf => leaf.remove());
            
            const existingGrass = document.querySelectorAll('.grass-blade');
            existingGrass.forEach(grass => grass.remove());
            
            const existingFlowers = document.querySelectorAll('.flower');
            existingFlowers.forEach(flower => flower.remove());
            
            // Create particles
            const particlesContainer = document.getElementById('particles');
            if (particlesContainer) {
                for (let i = 0; i < 35; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                particlesContainer.appendChild(particle);
                }
            }
            
            // Create trees
            const treesContainer = document.getElementById('trees');
            if (treesContainer) {
                for (let i = 0; i < 25; i++) {
                const tree = document.createElement('div');
                tree.className = 'tree';
                tree.style.left = Math.random() * 100 + '%';
                tree.style.height = (60 + Math.random() * 40) + 'px';
                tree.style.animationDelay = Math.random() * 3 + 's';
                treesContainer.appendChild(tree);
                }
            }
            
            // Create birds
            const birdsContainer = document.getElementById('birds');
            if (birdsContainer) {
                for (let i = 0; i < 12; i++) {
                const bird = document.createElement('div');
                bird.className = 'bird';
                bird.style.top = (10 + Math.random() * 30) + '%';
                bird.style.animationDelay = Math.random() * 25 + 's';
                bird.style.animationDuration = (20 + Math.random() * 10) + 's';
                birdsContainer.appendChild(bird);
                }
            }
            
            // Create leaves
            const leavesContainer = document.getElementById('leaves');
            if (leavesContainer) {
                for (let i = 0; i < 20; i++) {
                const leaf = document.createElement('div');
                leaf.className = 'leaf';
                leaf.style.left = Math.random() * 100 + '%';
                leaf.style.animationDelay = Math.random() * 8 + 's';
                leaf.style.animationDuration = (6 + Math.random() * 4) + 's';
                leavesContainer.appendChild(leaf);
                }
            }
            
            // Create grass
            const grassContainer = document.getElementById('grass');
            if (grassContainer) {
                for (let i = 0; i < 80; i++) {
                const grassBlade = document.createElement('div');
                grassBlade.className = 'grass-blade';
                grassBlade.style.left = Math.random() * 100 + '%';
                grassBlade.style.height = (15 + Math.random() * 15) + 'px';
                grassBlade.style.animationDelay = Math.random() * 3 + 's';
                grassContainer.appendChild(grassBlade);
                }
            }
            
            // Create flowers
            const flowersContainer = document.getElementById('flowers');
            if (flowersContainer) {
                for (let i = 0; i < 30; i++) {
                const flower = document.createElement('div');
                flower.className = 'flower';
                flower.style.left = Math.random() * 100 + '%';
                flower.style.animationDelay = Math.random() * 5 + 's';
                flowersContainer.appendChild(flower);
                }
            }
            
            // Add interactive mouse effects
            document.addEventListener('mousemove', function(e) {
                const mouseX = e.clientX / window.innerWidth;
                const mouseY = e.clientY / window.innerHeight;
                
                // Move clouds based on mouse position
                const clouds = document.querySelector('.clouds');
                if (clouds) {
                    clouds.style.transform = `translateX(${mouseX * 30}px) translateY(${mouseY * 15}px)`;
                }
                
                // Move sun rays based on mouse position
                const sunRays = document.querySelector('.sun-rays');
                if (sunRays) {
                    sunRays.style.transform = `translateX(${mouseX * 25}px) translateY(${mouseY * 20}px)`;
                }
                
                // Move mountains slightly
                const mountains = document.querySelector('.mountains');
                if (mountains) {
                    mountains.style.transform = `translateX(${mouseX * 10}px) translateY(${mouseY * 5}px)`;
                }
                
                // Move trees with wind effect
                const trees = document.querySelectorAll('.tree');
                trees.forEach((tree, index) => {
                    const intensity = (index % 3 + 1) * 2;
                    tree.style.transform = `translateX(${mouseX * intensity}px) rotate(${mouseX * 2}deg)`;
                });
                
                // Move grass with wind effect
                const grassBlades = document.querySelectorAll('.grass-blade');
                grassBlades.forEach((blade, index) => {
                    const intensity = (index % 5 + 1) * 1.5;
                    blade.style.transform = `translateX(${mouseX * intensity}px) rotate(${mouseX * 3}deg)`;
                });
                
                // Move particles
                const particles = document.querySelectorAll('.particle');
                particles.forEach((particle, index) => {
                    const intensity = (index % 4 + 1) * 3;
                    particle.style.transform = `translateX(${mouseX * intensity}px) translateY(${mouseY * intensity}px)`;
                });
            });
            
            // Add click effects for more interactivity
            document.addEventListener('click', function(e) {
                // Create ripple effect
                const ripple = document.createElement('div');
                ripple.style.position = 'absolute';
                ripple.style.left = e.clientX + 'px';
                ripple.style.top = e.clientY + 'px';
                ripple.style.width = '20px';
                ripple.style.height = '20px';
                ripple.style.background = 'rgba(255, 255, 255, 0.3)';
                ripple.style.borderRadius = '50%';
                ripple.style.transform = 'translate(-50%, -50%)';
                ripple.style.animation = 'ripple 0.6s ease-out';
                ripple.style.pointerEvents = 'none';
                ripple.style.zIndex = '1000';
                
                document.body.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);
            });
        }
        
        // Form handling functions
        function addNutritionEntry(event) {
            event.preventDefault();
            console.log('Adding nutrition entry...');
            
            const foodNameEl = document.getElementById('foodName');
            const caloriesEl = document.getElementById('calories');
            const quantityEl = document.getElementById('quantity');
            const dateEl = document.getElementById('nutritionDate');
            
            if (!foodNameEl || !caloriesEl || !quantityEl || !dateEl) {
                console.error('Form elements not found:', { foodNameEl, caloriesEl, quantityEl, dateEl });
                alert('Form elements not found. Please refresh the page.');
                return;
            }
            
            const foodName = foodNameEl.value;
            const calories = parseInt(caloriesEl.value);
            const quantity = quantityEl.value;
            const selectedDate = dateEl.value;
            
            console.log('Form data:', { foodName, calories, quantity, selectedDate });
            
            const entry = {
                id: Date.now(),
                foodName,
                calories,
                quantity,
                timestamp: new Date(selectedDate).toISOString()
            };
            
            console.log('Created entry:', entry);
            
            const userId = getCurrentUserId();
            console.log('User ID:', userId);
            const userData = JSON.parse(localStorage.getItem(`lifehub_data_${userId}`) || '{}');
            userData.nutrition = userData.nutrition || [];
            userData.nutrition.push(entry);
            console.log('Updated nutrition data:', userData.nutrition);
            saveData('nutrition', userData.nutrition);
            
            loadNutritionData(userData.nutrition);
            document.getElementById('foodName').value = '';
            document.getElementById('calories').value = '';
            document.getElementById('quantity').value = '';
            
            // Update dashboard summary
            updateDashboardSummary();
        }
        
        function addWater(amount) {
            console.log('Adding water entry:', amount);
            const waterDateInput = document.getElementById('waterDate');
            
            if (!waterDateInput) {
                console.error('Water date input not found');
                alert('Water date input not found. Please refresh the page.');
                return;
            }
            
            const selectedDate = waterDateInput.value || new Date().toISOString().split('T')[0];
            console.log('Water date:', selectedDate);
            
            const entry = {
                id: Date.now(),
                amount,
                timestamp: new Date(selectedDate).toISOString()
            };
            
            const userId = getCurrentUserId();
            console.log('User ID for water:', userId);
            const userData = JSON.parse(localStorage.getItem(`lifehub_data_${userId}`) || '{}');
            userData.water = userData.water || [];
            userData.water.push(entry);
            console.log('Updated water data:', userData.water);
            saveData('water', userData.water);
            
            loadWaterData(userData.water);
            
            // Update dashboard summary
            updateDashboardSummary();
        }
        
        function addCustomWater(event) {
            event.preventDefault();
            const amount = parseInt(document.getElementById('customWater').value);
            if (amount > 0) {
                addWater(amount);
                document.getElementById('customWater').value = '';
            }
        }
        
        function addExerciseEntry(event) {
            event.preventDefault();
            const exerciseType = document.getElementById('exerciseType').value;
            const duration = parseInt(document.getElementById('duration').value);
            const caloriesBurned = parseInt(document.getElementById('caloriesBurned').value) || 0;
            const selectedDate = document.getElementById('exerciseDate').value;
            
            const entry = {
                id: Date.now(),
                exerciseType,
                duration,
                caloriesBurned,
                timestamp: new Date(selectedDate).toISOString()
            };
            
            const userId = getCurrentUserId();
            const userData = JSON.parse(localStorage.getItem(`lifehub_data_${userId}`) || '{}');
            userData.exercise = userData.exercise || [];
            userData.exercise.push(entry);
            saveData('exercise', userData.exercise);
            
            loadExerciseData(userData.exercise);
            document.getElementById('exerciseType').value = '';
            document.getElementById('duration').value = '';
            document.getElementById('caloriesBurned').value = '';
            
            // Update dashboard summary
            updateDashboardSummary();
        }
        
        function selectMood(mood) {
            document.getElementById('selectedMood').value = mood;
            document.querySelectorAll('.mood-btn').forEach(btn => {
                btn.style.background = 'white';
                btn.style.borderColor = '#dee2e6';
            });
            event.target.style.background = '#e9ecef';
            event.target.style.borderColor = '#6f42c1';
        }
        
        function addMoodEntry(event) {
            event.preventDefault();
            const mood = document.getElementById('selectedMood').value;
            const notes = document.getElementById('moodNotes').value;
            const selectedDate = document.getElementById('moodDate').value;
            
            if (!mood) {
                alert('Please select a mood!');
                return;
            }
            
            const entry = {
                id: Date.now(),
                mood,
                notes,
                timestamp: new Date(selectedDate).toISOString()
            };
            
            const userId = getCurrentUserId();
            const userData = JSON.parse(localStorage.getItem(`lifehub_data_${userId}`) || '{}');
            userData.mood = userData.mood || [];
            userData.mood.push(entry);
            saveData('mood', userData.mood);
            
            loadMoodData(userData.mood);
            document.getElementById('selectedMood').value = '';
            document.getElementById('moodNotes').value = '';
            
            // Update dashboard summary
            updateDashboardSummary();
        }
        
        function addSleepEntry(event) {
            event.preventDefault();
            const duration = parseFloat(document.getElementById('sleepDuration').value);
            const quality = document.getElementById('sleepQuality').value;
            const notes = document.getElementById('sleepNotes').value;
            
            const entry = {
                id: Date.now(),
                duration,
                quality,
                notes,
                timestamp: new Date().toISOString()
            };
            
            const userId = getCurrentUserId();
            const userData = JSON.parse(localStorage.getItem(`lifehub_data_${userId}`) || '{}');
            userData.sleep = userData.sleep || [];
            userData.sleep.push(entry);
            saveData('sleep', userData.sleep);
            
            loadSleepData(userData.sleep);
            document.getElementById('sleepDuration').value = '';
            document.getElementById('sleepQuality').value = '';
            document.getElementById('sleepNotes').value = '';
            
            // Update dashboard summary
            updateDashboardSummary();
        }
        
        function addHabit(event) {
            event.preventDefault();
            const name = document.getElementById('habitName').value;
            const frequency = document.getElementById('habitFrequency').value;
            const description = document.getElementById('habitDescription').value;
            
            const habit = {
                id: Date.now(),
                name,
                frequency,
                description,
                createdAt: new Date().toISOString(),
                completions: []
            };
            
            const userId = getCurrentUserId();
            const userData = JSON.parse(localStorage.getItem(`lifehub_data_${userId}`) || '{}');
            userData.habits = userData.habits || [];
            userData.habits.push(habit);
            saveData('habits', userData.habits);
            
            loadHabitsData(userData.habits);
            document.getElementById('habitName').value = '';
            document.getElementById('habitFrequency').value = '';
            document.getElementById('habitDescription').value = '';
        }
        
        function addMedicalEntry(event) {
            event.preventDefault();
            const type = document.getElementById('medicalType').value;
            const value = parseFloat(document.getElementById('medicalValue').value);
            const info = document.getElementById('medicalInfo').value;
            const notes = document.getElementById('medicalNotes').value;
            
            const entry = {
                id: Date.now(),
                type,
                value,
                info,
                notes,
                timestamp: new Date().toISOString()
            };
            
            const userId = getCurrentUserId();
            const userData = JSON.parse(localStorage.getItem(`lifehub_data_${userId}`) || '{}');
            userData.medical = userData.medical || [];
            userData.medical.push(entry);
            saveData('medical', userData.medical);
            
            loadMedicalData(userData.medical);
            document.getElementById('medicalType').value = '';
            document.getElementById('medicalValue').value = '';
            document.getElementById('medicalInfo').value = '';
            document.getElementById('medicalNotes').value = '';
        }
        
        function completeHabit(habitId) {
            const userId = getCurrentUserId();
            const userData = JSON.parse(localStorage.getItem(`lifehub_data_${userId}`) || '{}');
            const habit = userData.habits.find(h => h.id === habitId);
            
            if (habit) {
                const today = new Date().toDateString();
                const todayCompletion = habit.completions.find(c => new Date(c.date).toDateString() === today);
                
                if (!todayCompletion) {
                    habit.completions.push({
                        date: new Date().toISOString(),
                        timestamp: new Date().toISOString()
                    });
                    saveData('habits', userData.habits);
                    loadHabitsData(userData.habits);
                }
            }
        }
        
        // Data loading functions
        function loadNutritionData(entries) {
            const container = document.getElementById('nutritionEntries');
            if (!container) return;
            
            if (entries.length === 0) {
                container.innerHTML = '<p style="color: #6c757d; text-align: center; margin: 20px 0;">No entries yet. Add your first meal!</p>';
                return;
            }
            
            const today = new Date().toDateString();
            const todayEntries = entries.filter(entry => new Date(entry.timestamp).toDateString() === today);
            
            if (todayEntries.length === 0) {
                container.innerHTML = '<p style="color: #6c757d; text-align: center; margin: 20px 0;">No entries today. Add your first meal!</p>';
                return;
            }
            
            container.innerHTML = todayEntries.map(entry => `
                <div style="background: rgba(40, 167, 69, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #28a745;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: bold; color: #0d3d0d;">${entry.foodName}</div>
                            <div style="color: #6c757d; font-size: 14px;">${entry.quantity}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-weight: bold; color: #28a745;">${entry.calories} cal</div>
                            <div style="color: #6c757d; font-size: 12px;">${new Date(entry.timestamp).toLocaleTimeString()}</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function loadWaterData(entries) {
            const container = document.getElementById('waterEntries');
            const totalContainer = document.getElementById('totalWater');
            if (!container || !totalContainer) return;
            
            const today = new Date().toDateString();
            const todayEntries = entries.filter(entry => new Date(entry.timestamp).toDateString() === today);
            const total = todayEntries.reduce((sum, entry) => sum + entry.amount, 0);
            
            totalContainer.textContent = total;
            
            if (todayEntries.length === 0) {
                container.innerHTML = '<p style="color: #6c757d; text-align: center; margin: 20px 0;">No water logged yet. Stay hydrated!</p>';
                return;
            }
            
            container.innerHTML = todayEntries.map(entry => `
                <div style="background: rgba(0, 123, 255, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #007bff;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="font-weight: bold; color: #0d3d0d;">${entry.amount}ml</div>
                        <div style="color: #6c757d; font-size: 12px;">${new Date(entry.timestamp).toLocaleTimeString()}</div>
                    </div>
                </div>
            `).join('');
        }
        
        function loadExerciseData(entries) {
            const container = document.getElementById('exerciseEntries');
            if (!container) return;
            
            const today = new Date().toDateString();
            const todayEntries = entries.filter(entry => new Date(entry.timestamp).toDateString() === today);
            
            if (todayEntries.length === 0) {
                container.innerHTML = '<p style="color: #6c757d; text-align: center; margin: 20px 0;">No workouts logged yet. Get moving!</p>';
                return;
            }
            
            container.innerHTML = todayEntries.map(entry => `
                <div style="background: rgba(253, 126, 20, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #fd7e14;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: bold; color: #0d3d0d;">${entry.exerciseType}</div>
                            <div style="color: #6c757d; font-size: 14px;">${entry.duration} minutes</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-weight: bold; color: #fd7e14;">${entry.caloriesBurned} cal</div>
                            <div style="color: #6c757d; font-size: 12px;">${new Date(entry.timestamp).toLocaleTimeString()}</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function loadMoodData(entries) {
            const container = document.getElementById('moodEntries');
            if (!container) return;
            
            const today = new Date().toDateString();
            const todayEntries = entries.filter(entry => new Date(entry.timestamp).toDateString() === today);
            
            if (todayEntries.length === 0) {
                container.innerHTML = '<p style="color: #6c757d; text-align: center; margin: 20px 0;">No mood entries yet. Check in with yourself!</p>';
                return;
            }
            
            container.innerHTML = todayEntries.map(entry => `
                <div style="background: rgba(111, 66, 193, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #6f42c1;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div style="font-size: 24px;">${entry.mood}</div>
                        <div style="color: #6c757d; font-size: 12px;">${new Date(entry.timestamp).toLocaleTimeString()}</div>
                    </div>
                    ${entry.notes ? `<div style="color: #0d3d0d; font-size: 14px; font-style: italic;">"${entry.notes}"</div>` : ''}
                </div>
            `).join('');
        }
        
        function loadSleepData(entries) {
            const container = document.getElementById('sleepEntries');
            if (!container) return;
            
            if (entries.length === 0) {
                container.innerHTML = '<p style="color: #6c757d; text-align: center; margin: 20px 0;">No sleep logs yet. Log your first night!</p>';
                return;
            }
            
            container.innerHTML = entries.slice(-10).reverse().map(entry => `
                <div style="background: rgba(240, 248, 255, 0.7); padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #2196f3;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <div style="font-weight: bold; color: #1976d2;">${entry.duration} hours</div>
                        <div style="font-size: 20px;">${entry.quality}</div>
                    </div>
                    <div style="color: #6c757d; font-size: 12px; margin-bottom: 5px;">
                        ${new Date(entry.timestamp).toLocaleDateString()} at ${new Date(entry.timestamp).toLocaleTimeString()}
                    </div>
                    ${entry.notes ? `<div style="color: #0d3d0d; font-size: 14px; font-style: italic;">"${entry.notes}"</div>` : ''}
                </div>
            `).join('');
        }
        
        function loadHabitsData(habits) {
            const container = document.getElementById('habitsList');
            if (!container) return;
            
            if (habits.length === 0) {
                container.innerHTML = '<p style="color: #6c757d; text-align: center; margin: 20px 0;">No habits yet. Start building your first habit!</p>';
                return;
            }
            
            container.innerHTML = habits.map(habit => {
                const today = new Date().toDateString();
                const todayCompleted = habit.completions.some(c => new Date(c.date).toDateString() === today);
                const streak = calculateStreak(habit.completions);
                
                return `
                    <div style="background: rgba(248, 255, 248, 0.7); padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #4caf50;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <div style="font-weight: bold; color: #388e3c;">${habit.name}</div>
                            <div style="font-size: 12px; color: #6c757d;">${habit.frequency}</div>
                        </div>
                        <div style="color: #6c757d; font-size: 12px; margin-bottom: 10px;">
                            Streak: ${streak} days | Total: ${habit.completions.length} completions
                        </div>
                        ${habit.description ? `<div style="color: #0d3d0d; font-size: 14px; margin-bottom: 10px;">${habit.description}</div>` : ''}
                        <button onclick="completeHabit(${habit.id})" 
                                style="background: ${todayCompleted ? '#4caf50' : '#e0e0e0'}; color: ${todayCompleted ? 'white' : '#666'}; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; font-size: 12px;"
                                ${todayCompleted ? 'disabled' : ''}>
                            ${todayCompleted ? '‚úÖ Completed Today' : 'Mark Complete'}
                        </button>
                    </div>
                `;
            }).join('');
        }
        
        function loadMedicalData(entries) {
            const container = document.getElementById('medicalEntries');
            if (!container) return;
            
            if (entries.length === 0) {
                container.innerHTML = '<p style="color: #6c757d; text-align: center; margin: 20px 0;">No health metrics logged yet. Start tracking your vitals!</p>';
                return;
            }
            
            container.innerHTML = entries.slice(-10).reverse().map(entry => {
                const typeLabels = {
                    'blood_pressure': 'Blood Pressure',
                    'heart_rate': 'Heart Rate',
                    'glucose': 'Blood Glucose',
                    'weight': 'Weight',
                    'temperature': 'Temperature',
                    'other': 'Other'
                };
                
                return `
                    <div style="background: rgba(255, 245, 245, 0.7); padding: 15px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #f44336;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <div style="font-weight: bold; color: #d32f2f;">${typeLabels[entry.type] || entry.type}</div>
                            <div style="font-size: 18px; font-weight: bold; color: #d32f2f;">${entry.value}${getUnit(entry.type)}</div>
                        </div>
                        <div style="color: #6c757d; font-size: 12px; margin-bottom: 5px;">
                            ${new Date(entry.timestamp).toLocaleDateString()} at ${new Date(entry.timestamp).toLocaleTimeString()}
                        </div>
                        ${entry.info ? `<div style="color: #0d3d0d; font-size: 14px; margin-bottom: 5px;">${entry.info}</div>` : ''}
                        ${entry.notes ? `<div style="color: #0d3d0d; font-size: 14px; font-style: italic;">"${entry.notes}"</div>` : ''}
                    </div>
                `;
            }).join('');
        }
        
        function calculateStreak(completions) {
            if (completions.length === 0) return 0;
            
            const sortedCompletions = completions.sort((a, b) => new Date(b.date) - new Date(a.date));
            let streak = 0;
            let currentDate = new Date();
            
            for (let completion of sortedCompletions) {
                const completionDate = new Date(completion.date);
                const daysDiff = Math.floor((currentDate - completionDate) / (1000 * 60 * 60 * 24));
                
                if (daysDiff === streak) {
                    streak++;
                    currentDate = completionDate;
                } else {
                    break;
                }
            }
            
            return streak;
        }
        
        function getUnit(type) {
            const units = {
                'blood_pressure': ' mmHg',
                'heart_rate': ' bpm',
                'glucose': ' mg/dL',
                'weight': ' lbs',
                'temperature': '¬∞F',
                'other': ''
            };
            return units[type] || '';
        }
        
        function loadAnalyticsData(data) {
            const today = new Date().toDateString();
            
            // Calculate totals for today
            const nutritionEntries = (data.nutrition || []).filter(entry => new Date(entry.timestamp).toDateString() === today);
            const waterEntries = (data.water || []).filter(entry => new Date(entry.timestamp).toDateString() === today);
            const exerciseEntries = (data.exercise || []).filter(entry => new Date(entry.timestamp).toDateString() === today);
            const moodEntries = (data.mood || []).filter(entry => new Date(entry.timestamp).toDateString() === today);
            
            const totalCalories = nutritionEntries.reduce((sum, entry) => sum + entry.calories, 0);
            const totalWater = waterEntries.reduce((sum, entry) => sum + entry.amount, 0);
            const totalExercise = exerciseEntries.reduce((sum, entry) => sum + entry.duration, 0);
            
            // Calculate average mood
            let averageMood = 'üòä';
            if (moodEntries.length > 0) {
                const moodValues = moodEntries.map(entry => {
                    switch(entry.mood) {
                        case 'üò¢': return 1;
                        case 'üòê': return 2;
                        case 'üòä': return 3;
                        case 'üòÑ': return 4;
                        case 'ü§©': return 5;
                        default: return 3;
                    }
                });
                const avg = moodValues.reduce((sum, val) => sum + val, 0) / moodValues.length;
                if (avg <= 1.5) averageMood = 'üò¢';
                else if (avg <= 2.5) averageMood = 'üòê';
                else if (avg <= 3.5) averageMood = 'üòä';
                else if (avg <= 4.5) averageMood = 'üòÑ';
                else averageMood = 'ü§©';
            }
            
            // Update display
            const totalCaloriesEl = document.getElementById('totalCalories');
            const totalWaterEl = document.getElementById('totalWaterAnalytics');
            const totalExerciseEl = document.getElementById('totalExercise');
            const averageMoodEl = document.getElementById('averageMood');
            
            if (totalCaloriesEl) totalCaloriesEl.textContent = totalCalories;
            if (totalWaterEl) totalWaterEl.textContent = totalWater;
            if (totalExerciseEl) totalExerciseEl.textContent = totalExercise;
            if (averageMoodEl) averageMoodEl.textContent = averageMood;
            
            // Draw charts after a short delay to ensure canvas elements are rendered
            setTimeout(() => {
                drawAllCharts(data);
            }, 100);
        }
        
        // Chart drawing functions
        function drawChart(canvasId, data, color, label) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) {
                console.log('Canvas not found:', canvasId);
                return;
            }
            
            const ctx = canvas.getContext('2d');
            const container = canvas.parentElement;
            const width = canvas.width = container.offsetWidth - 40; // Account for padding
            const height = canvas.height = 160; // Fixed height for consistency
            
            // Clear canvas
            ctx.clearRect(0, 0, width, height);
            
            if (data.length === 0) {
                ctx.fillStyle = '#6c757d';
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('No data available', width / 2, height / 2);
                return;
            }
            
            const padding = 40;
            const chartWidth = width - 2 * padding;
            const chartHeight = height - 2 * padding;
            
            // Find max value
            const maxValue = Math.max(...data.map(d => d.value), 1);
            
            // Draw axes
            ctx.strokeStyle = '#dee2e6';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, height - padding);
            ctx.lineTo(width - padding, height - padding);
            ctx.stroke();
            
            // Draw grid lines
            ctx.strokeStyle = '#f8f9fa';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(width - padding, y);
                ctx.stroke();
            }
            
            // Draw bars
            const barWidth = chartWidth / data.length * 0.8;
            const barSpacing = chartWidth / data.length;
            
            data.forEach((item, index) => {
                const barHeight = (item.value / maxValue) * chartHeight;
                const x = padding + index * barSpacing + (barSpacing - barWidth) / 2;
                const y = height - padding - barHeight;
                
                // Draw bar
                ctx.fillStyle = color;
                ctx.fillRect(x, y, barWidth, barHeight);
                
                // Draw value on top
                ctx.fillStyle = '#0d3d0d';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(item.value.toString(), x + barWidth / 2, y - 5);
                
                // Draw label
                ctx.fillStyle = '#6c757d';
                ctx.font = '10px Arial';
                ctx.fillText(item.label, x + barWidth / 2, height - padding + 15);
            });
        }
        
        function generateChartData(entries, valueField, labelField) {
            // Get all unique dates from entries
            const uniqueDates = [...new Set(entries.map(entry => 
                new Date(entry.timestamp).toDateString()
            ))].sort();
            
            // If no entries, return empty array
            if (uniqueDates.length === 0) {
                return [];
            }
            
            const chartData = [];
            uniqueDates.forEach(dateStr => {
                const date = new Date(dateStr);
                const dayLabel = date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
                
                const dayEntries = entries.filter(entry => 
                    new Date(entry.timestamp).toDateString() === dateStr
                );
                
                const total = dayEntries.reduce((sum, entry) => sum + (entry[valueField] || 0), 0);
                
                chartData.push({
                    label: dayLabel,
                    value: total
                });
            });
            
            return chartData;
        }
        
        function generateMoodChartData(entries) {
            // Get all unique dates from entries
            const uniqueDates = [...new Set(entries.map(entry => 
                new Date(entry.timestamp).toDateString()
            ))].sort();
            
            // If no entries, return empty array
            if (uniqueDates.length === 0) {
                return [];
            }
            
            const chartData = [];
            uniqueDates.forEach(dateStr => {
                const date = new Date(dateStr);
                const dayLabel = date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
                
                const dayEntries = entries.filter(entry => 
                    new Date(entry.timestamp).toDateString() === dateStr
                );
                
                let avgMood = 0;
                if (dayEntries.length > 0) {
                    const moodValues = dayEntries.map(entry => {
                        switch(entry.mood) {
                            case 'üò¢': return 1;
                            case 'üòê': return 2;
                            case 'üòä': return 3;
                            case 'üòÑ': return 4;
                            case 'ü§©': return 5;
                            default: return 3;
                        }
                    });
                    avgMood = moodValues.reduce((sum, val) => sum + val, 0) / moodValues.length;
                }
                
                chartData.push({
                    label: dayLabel,
                    value: avgMood
                });
            });
            
            return chartData;
        }
        
        function drawAllCharts(data) {
            console.log('Drawing charts with data:', data);
            
            // Draw calorie chart
            const calorieData = generateChartData(data.nutrition || [], 'calories', 'foodName');
            console.log('Calorie data:', calorieData);
            drawChart('calorieCanvas', calorieData, '#28a745', 'Calories');
            
            // Draw water chart
            const waterData = generateChartData(data.water || [], 'amount', 'amount');
            console.log('Water data:', waterData);
            drawChart('waterCanvas', waterData, '#007bff', 'Water (ml)');
            
            // Draw exercise chart
            const exerciseData = generateChartData(data.exercise || [], 'duration', 'exerciseType');
            console.log('Exercise data:', exerciseData);
            drawChart('exerciseCanvas', exerciseData, '#fd7e14', 'Minutes');
            
            // Draw mood chart
            const moodData = generateMoodChartData(data.mood || []);
            console.log('Mood data:', moodData);
            drawChart('moodCanvas', moodData, '#6f42c1', 'Mood');
        }
        
        // Test if JavaScript is working on page load
        window.onload = function() {
            console.log('Page loaded, JavaScript is working');
            
            // Create nature elements
            createNatureElements();
            
            // Check if user is already logged in
            const savedUser = localStorage.getItem('lifehub_user');
            if (savedUser) {
                showDashboard();
            } else {
                showMessage('‚úÖ Welcome to LifeHub! Please sign in or create a new account to continue.', 'success');
            }
        };
    </script>
</body>
</html>
